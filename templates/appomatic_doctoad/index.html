{% extends 'appomatic_doctoad/base.html' %}

{% block menu %}
  <li class="active"><a href="{% url 'appomatic_doctoad.views.index' %}?treeish={{request.GET.treeish}}">Files</a></li>
  {% if request.GET.treeish and request.GET.treeish != 'master' %}
    <li><a href="{% url 'appomatic_doctoad.views.change' %}?treeish={{request.GET.treeish}}">Differences</a></li>
  {% endif %}
  <li><a href="{% url 'appomatic_doctoad.views.log' %}?treeish={{request.GET.treeish}}">Log</a></li>
{% endblock %}

{% block content_title %}{% endblock %}
{% block content %}

  <div class="row">
    <div class="col-md-8">
      {% if request.GET.treeish and request.GET.treeish != 'master' %}
        <h1>{{request.GET.treeish}}</h1>
      {% endif %}
      <h2>Files</h2>
      <ul>
        {% for file in repo.ls_files %}
          <li><a href="{% url 'appomatic_doctoad.views.file' %}?treeish={{request.GET.treeish}}&file={{file}}">{{file}}</a></li>
        {% endfor %}
        <li>
          <form method="GET" action="{% url 'appomatic_doctoad.views.file' %}?treeish={{request.GET.treeish}}">
            Create new: <input type="text" name="file"> <button type="submit" class="btn btn-default">Add</button>
          </form>
        </li>
      </ul>
    </div>
    <div class="col-md-4">
      {% if not request.GET.treeish or request.GET.treeish == 'master' %}
        <h1>Open change requests</h1>
        <ul>
          {% for treeish in repo.branches.open %}
            <li><a href="{% url 'appomatic_doctoad.views.change' %}?treeish={{treeish}}">{{treeish}}</a></li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
  </div>
{% endblock %}
